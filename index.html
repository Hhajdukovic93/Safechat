<!DOCTYPE html>
<html>


	<head>
		<title>Safechat</title>
		<meta charset="utf-8">

		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">

		<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

		<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.0.3/socket.io.js"></script>

		<style type="text/css">
			body {
				margin-top: 50px;
			}
		</style>


	</head>


	<body>
		
		<div class="container">		
			<div class="row">

				<div class="col-sm-4">
					<div class="well">
						<h3>Online Users</h3>
						<ul class ="list-group" id="users"></ul>
					</div>
				</div>


				<div class="col-sm-8">
					<div class="chat" id="chat"></div>
					<form id="messageForm">
						<div class="form-group">
							<label> Enter Message : </label>
							<textarea class="form-control" id="message"></textarea>
							<br/>
							<input type="submit" class="btn btn-primaty" value="Send Message">
						</div>
					</form>
				</div>
				
			</div>
		</div>



		<script type="text/javascript">
			
			$(function(){
				var socket = io.connect();

				// Chat DIV
				var chat = $('#chat');
				// Form
				var messageForm = $('#messageForm');
				// Main object - message
				var message = $('#message');

				// Do methods after message form is submitted via click on button
				messageForm.submit(function(e){
					e.preventDefault();
					// Display action - message is submitted by user
					console.log('Message submitted')

					// Emit message - catch message from textarea with id="message"
					socket.emit('send message', message.val());
					// Make textarea empty after submit, ready for new message by user
					message.val('');
				});


				// Get new message and display it in chat window by adding new DIV
				socket.on('new message', function(data){
					chat.append('<div class="well">'+data.msg+'</div>')
				});

			});
		</script>


	</body>


</html>